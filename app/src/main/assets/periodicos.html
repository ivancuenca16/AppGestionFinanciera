<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Periódicos - FinanApp</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 16px; }
        h2 { text-align: center; margin-bottom: 24px; }
        canvas { max-width: 100%; margin: 16px 0; }
    </style>
</head>
<body>
<h2>Estadísticas FinanApp</h2>
<canvas id="pieChart"></canvas>
<canvas id="barWeekly"></canvas>
<canvas id="barMonthly"></canvas>

<script>
    // Esta función la llamaremos desde Android
    function renderCharts() {
      // Llamamos a la interfaz y parseamos JSON
      const raw = window.finData.getChartData();
      let data;
      try {
        data = JSON.parse(raw);
      } catch (e) {
        console.error("JSON inválido:", raw);
        return;
      }

      // 1) Pie Chart (Ingresos vs Gastos)
      new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: {
          labels: ['Ingresos', 'Gastos'],
          datasets: [{
            data: [data.sumIn, data.sumOut],
            backgroundColor: ['#388E3C','#D32F2F']
          }]
        },
        options: { responsive: true }
      });

      // 2) Bar Weekly (últimas 4 semanas)
      new Chart(document.getElementById('barWeekly'), {
        type: 'bar',
        data: {
          labels: data.labelsWeekly,
          datasets: [{
            label: 'Neto Semanal',
            data: data.valuesWeekly,
            backgroundColor: '#1976D2'
          }]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
      });

      // 3) Bar Monthly (últimos 12 meses)
      new Chart(document.getElementById('barMonthly'), {
        type: 'bar',
        data: {
          labels: data.labelsMonthly,
          datasets: [{
            label: 'Neto Mensual',
            data: data.valuesMonthly,
            backgroundColor: '#512DA8'
          }]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
      });
    }
</script>
</body>
</html>
